!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);class n{constructor(e,t,i=!1){this.debug=i;const s="#JSGF V1.0; grammar phrases; public <phrases> = "+t.join(" | ")+";";this.recognition=new(n._instance());const o=new(n._grammar());o.addFromString(s,1),this.recognition.grammars=o,this.recognition.continuous=!0,this.recognition.interimResults=!1,this.recognition.maxAlternatives=1,this.recognition.lang=e,this.started=!1,this.recognition.onstart=(()=>{this.debug&&console.log("DEBUG: Recognition start..."),this.started=!0}),this.recognition.onend=(()=>{this.debug&&console.log("DEBUG: Recognition end!"),this.started=!1,this.recognition.start()}),this.recognition.onnomatch=(e=>{this.debug&&console.log("DEBUG: No match!")})}listen(e){this.recognition.onresult=(t=>{let i=t.results[t.resultIndex][0];e({text:i.transcript.trim().toLowerCase(),confidence:i.confidence})}),this.started||this.recognition.start()}static isSupported(){return!(!n._instance()||!n._grammar())}static _instance(){return window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition}static _grammar(){return window.SpeechGrammarList||window.webkitSpeechGrammarList}}var s=n;var o=class{static isSupported(){return"speechSynthesis"in window}constructor(e,t,i,n,s=!1){window.utterances=[],this.lang=e,this.volume=t,this.voiceId=i,this.speed=n,this.voices=window.speechSynthesis.getVoices(),this.voicesLoaded=!1,this.debug=s}init(){return new Promise((e,t)=>{window.speechSynthesis.onvoiceschanged=(()=>{this.voices=window.speechSynthesis.getVoices(),console.log(this.voices),this.utterance=new window.SpeechSynthesisUtterance,this.utterance.voice=this.voices[this.voiceId],this.utterance.voiceURI="native",this.utterance.volume=this.volume,this.utterance.lang=this.lang,this.utterance.rate=this.speed,this.voices.length>0&&!this.voicesLoaded&&(this.voicesLoaded=!0,e())})})}say(e){return new Promise((t,i)=>{e||t(),window.speechSynthesis.cancel(),this.utterance.text=e,this.debug&&console.log("DEBUG: Start speak -> ",e),window.utterances.push(this.utterance),this.utterance.onend=(()=>{console.log("finished"),t()}),window.speechSynthesis.speak(this.utterance)})}};var r=class{analyze(){return new Promise((e,t)=>{e(document.getElementById("page-description").innerText)})}};var a=class{constructor(e,t,i,n,s,o,r,a=!1){this._recognition=e,this._synthesizer=t,this._pageReader=i,this._startCommand=n,this._soundEffect=new Audio(s),this._actions=o,this._stopWords=r,this._debug=a,this._waitingNextSpeech=!1}listen(e){this._recognition.listen(t=>{const i=t.text.toLowerCase().trim()===this._startCommand.toLowerCase().trim();this._debug&&console.log("DEBUG: ",t.text),i&&this._soundEffect.play(),this._waitingNextSpeech&&(this._waitingNextSpeech=!1,this._extractAction(t),this._extractKeyword(t),e(t)),this._waitingNextSpeech=i})}say(e,t=(()=>{})){this._synthesizer.say(e).then(()=>{"function"==typeof t&&t()})}describePage(e=(()=>{})){const t=this;this._pageReader.analyze().then(i=>{if(i.length<120)t.say(i,()=>{e()});else{const n=i.split(/[\\.!\?]/);let s=[];s.length=n.length,n.map((i,n)=>{n===s.length-1?"function"==typeof e&&(s[n]=(()=>{t.say(i,()=>{e()})})):s[n]=(()=>{t.say(i,s[n+1])})}),s[0]()}})}_extractKeyword(e){const t=e.text.split(" "),i=[];for(let n=0;t.length>n;n++)-1===this._stopWords.indexOf(t[n])&&t[n]!==e.action||i.push(t[n]);for(let e=0;i.length>e;e++){const n=t.indexOf(i[e]);-1!==n&&t.splice(n,1)}e.keywords=t}_extractAction(e){for(let t=0;this._actions.length>t;t++){let i=this._actions[t].toLowerCase().trim();if(-1!=e.text.indexOf(i)){e.action=i;break}}return e}};var c=class{static start(e){return new Promise((t,i)=>{if(s.isSupported())if(o.isSupported()){const i=new s(e.lang,e.grammar,e.debug),n=new o(e.lang,e.volume,e.voiceId,e.speed,e.debug),c=new r;n.init().then(()=>{t(new a(i,n,c,e.startCommand,e.soundEffect,e.actions,e.stopWords,e.debug))})}else i("Voice synthesizer is not supported for this Browser.");else i("Voice recognition is not supported for this Browser.")})}};window.addEventListener("load",e=>{c.start({lang:"pt-BR",volume:1,voiceId:14,speed:1.5,startCommand:"Ok Luiza",soundEffect:"/assets/audio/beep.wav",grammar:["ok","Luiza","Ok Luiza","pesquisar","pesquisar por","pedidos","meus pedidos","ir para meus pedidos","carrinho","meu carrinho","ir para meu carrinho","inicial","página inicial","onde estou"],stopWords:["o","a","um","uma","por","para","de","da","ok","luiza"],actions:["descreva","pesquisar","buscar","pedido","carrinho","sacola","inicial","onde estou"],debug:!0}).then(e=>{e.listen(t=>{let i=t.keywords.join(" ");const n=t.action;-1!==["pesquisar","buscar"].indexOf(n)&&i.length>0?e.say("Pesquisando "+i,()=>{(e=>document.getElementById("search").value=e)(i)}):-1!==["carrinho","sacola"].indexOf(n)?e.say("Redirecionando para a página do carrinho",()=>{window.location.replace("/carrinho")}):"pedido"===n?e.say("Redirecionando para a página de pedidos",()=>{window.location.replace("/pedidos")}):"inicial"===n?e.say("Redirecionando para a página inicial",()=>{window.location.replace("/")}):"onde estou"===n?e.say("Você está na página: "+(()=>document.getElementById("location").innerText.replace("/","").replace("Página:",""))()):"descreva"===n?e.describePage():e.say("Não entendi o que deseja. Você pode repetir?")})}).catch(e=>{console.error(e)})})}]);